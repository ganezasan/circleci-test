version: 2
jobs:
  build:
    docker:
      - image: centos/python-36-centos7
        user: root
    environment:
      HOME: /opt/app-root/src
    working_directory: /opt/app-root/src/project
    steps:
      - run:
          name: Avoid hosts unknown for github
          command: |
            ln -s ~/.ssh/ /root/
      - run: 
          name: check OS environment
          command: |
            cat /etc/os-release
            uname -r
            python --version
            pip --version
            pwd
            ls -alh
            export USER=$(id -un)
            echo "user is $USER"
            id -un && id -gn
            yum install -y sudo
            usermod -aG wheel $USER
            cat /etc/sudoers
            chown -R $USER /usr/local
      - checkout
      - run: 
          name: check known_hosts
          command: |
            cat ~/.ssh/known_hosts


workflows:
  version: 2
  app:
    jobs:
      - build
